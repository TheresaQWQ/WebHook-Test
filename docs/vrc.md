---
title: "Animator Parameters"
slug: "animator-parameters"
hidden: false
createdAt: "2020-08-05T22:30:32.065Z"
updatedAt: "2023-04-07T14:38:34.913Z"
---
：：：注意统一所需知识

本文档的编写假设您对[Unity动画师](https://docs.unity3d.com/2019.4/Documentation/Manual/class-AnimatorController.html)有所了解。

:::

这是一个参数列表（**区分大小写**），可以添加到任何可播放层（动画控制器）并在包含此参数的所有可播放层之间进行更改。不在此列表中的用户创建的参数将仅存在于该动画控制器中的本地，并且当前不能由头像更改。

您需要将这些添加到您的可播放图层动画师中才能使用它们。**它们区分大小写！**

：：：危险不要死胡同！

你应该假设参数值可能会改变。如果你的动画师“死胡同”，这意味着你在任何特定的分支中都没有“出口”，你最终可能会有一个破碎的头像。

:::
## Parameters

|名称|描述|类型|同步|
|----------------------------------|------------------------------------------------------------ | ----------- | -------------- |
|IsLocal|如果头像在本地佩戴，则为真，否则为假|布尔|无|
|[维赛姆](/avatars/animator-parameters#viseme-values) | [眼视觉指数](https://developer.oculus.com/documentation/unity/audio-ovrlipsync-viseme-reference)（'0-14'）。使用颌骨/颌骨瓣时，范围为'0-100'，表示音量|智力|语音|
|语音|麦克风音量（'0.0-1.0'）|浮动|语音|
|[手势左转](/avatars/animator-parameters#gestureleft-and-gestureright-values)|手势从L手控制（0-7）|智力|IK|
|[手势正确](/avatars/animator-parameters#gestureleft-and-gestureright-values)|手势来自R手控制（0-7）|智力|IK|
|GestureLeftWeight|模拟触发器L（0.0-1.0）|浮动|可玩|
|GestureRightWeight|模拟触发器R（0.0-1.0）|浮动|可玩|
|AngularY|Y轴上的角速度|浮动|IK|
|VelocityX|以m/s为单位的横向移动速度|浮动|IK|
|VelocityY|垂直移动速度（m/s）|浮动|IK|
|VelocityZ|以m/s为单位的前进速度|浮动|IK|
|速度幅度|总速度幅值|浮点|IK|
|直立|你有多“直立”。0是俯卧，1是直立|浮动|IK|
|接地|如果玩家接触地面，则为真|布尔|IK|
|坐着|如果玩家在站真|布尔|IK|
|挂机|播放器不可用（HMD接近传感器/结束键）|Bool|IK|
|Expression1-Expression16|用户定义参数，Int（'0'-'255'）或Float（'-1.0'-'1.0'）|Int/Float|IK或可玩|
|[追踪类型](/avatars/animator-parameters#trackingtype-parameter)|请参阅下面的描述|智力|可播放|
|VRMode|如果用户在VR中，则返回“1”，如果他们不在，则返回“0”|智力|IK|
|静音|如果用户静音，则返回“真”，如果未静音，则返回“假”|布尔|可播放|
|InStation|如果用户在站中，则返回“真”，如果不是，则返回“假”|布尔|IK|
|耳罩|如果用户的耳罩功能打开，则返回“真”，如果没有，则返回“假”|布尔|可玩|
|IsOnFriendsList|如果查看头像的用户与佩戴头像的用户是朋友，则返回“真”。'假'本地。|布尔|其他|
|[头像版](/worlds/components/vrc_station/#sdk3-station-with-sdk2sdk3-avatar)|如果头像是使用VRChat的SDK3（2020.3.2）或更高版本构建的，则返回“3”，如果不是，则返回“0”。|智力|IK|

“仰卧”和“GroundProximity”在Debug显示中可见，但尚未实现。它们当前什么也不做，也从不更改值。

根据扣动扳机的不同，GestureLeftWeight和GestureRightWeight在各种手势中从0.0上升到1.0。例如，如果你握紧拳头，但没有在左手扣动扳机，GestureLeftWeight将是1，但GestureLeftWeight将是0.0。当你开始扣动扳机时，它将从0.0攀升到1.0。这可用于创建“模拟”手势或有条件地检测各种事物。

### 头像缩放参数

|名称|描述|类型|同步|
| ------------------ | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ----- | -------- |
|ScaleModified|如果用户使用头像缩放进行缩放，则返回“真”，如果头像处于默认大小，则返回“假”。|布尔|可播放|
|ScaleFactor|头像的默认高度和当前高度之间的关系。默认眼睛高度为1m缩放到2m的头像将报告“2”。|浮动|可玩|
|ScaleFactorInverse|头像的默认高度和当前高度之间的反比关系（“1/x”）。默认眼睛高度为1m的头像缩放到2m将报告“0.5”。极端情况下可能不准确。|浮动|可玩|
|EyeHeightAsMeter|化身的眼睛高度以米为单位。|浮动|可玩|
|EyeHeightAsPercent|头像眼睛高度相对于默认缩放限制（'0.2'-'5.0'）的米关系。缩放到2m的头像将报告'（2.0-0.2）/（5.0-0.2）'='0.375'。|浮动|可玩|

所有这些参数都是只读的。

### 参数类型

在参数对象中定义参数时，您可以访问三种类型的变量。

您最多可以使用256位的“内存”。这不是头像内存使用意义上的严格内存，而是与您在同步参数时使用的带宽有关。

|参数类型|范围|内存使用|笔记|
| :------------- | :---------------- | :----------- | :---------------------------------|
|'int'|'0'-'255'|8位|无符号8位int.|
|“浮点数”|“-1.0”到“1.0”|8位|有符号的8位定点小数。|
|'bool'|'True'or'False'|1位||

远程同步的“浮点数”值有255个可能的值，在网络上给出“1/127”的精度，并且可以精确地存储“-1.0”、“0.0”和“1.0”。当本地更新时，例如使用[OSC](https://docs.vrchat.com/docs/osc-overview)，浮点数值在动画师中存储为本机（32位）浮点值。

### GestureNorth和Gestureright值

GestureNorth和Gestureright使用这些作为它们的值：

|索引|手势|
| ----- | ----------- |
|0|中性|
|1|拳头|
|2|手开|
|3|指尖|
|4|胜利|
|5|RockNRoll|
|6|手枪|
|7|拇指向上|

### 可视化值

我们使用[眼视觉指数](https://developer.oculus.com/documentation/unity/audio-ovrlipsync-viseme-reference)，从上到下，其中'sil'为0。供参考：

可视化参数
| :--------------- | :----- |
|0|'sil'|
|1|'pp'|
|2|'ff'|
|3|'th'|
|4|'dd'|
|5|'kk'|
|6|'ch'|
|7|'ss'|
|8|'nn'|
|9|'rr'|
|10|'aa'|
|11|'e'|
|12|'i'|
|13|'o'|
|14|'u'|

### Sync Types

-**语音**-仅用于visemes，由Oculus Lithy nc输出参数驱动，具体取决于您的语音。本地更新，不直接同步（因为它由音频驱动）
-**可播放**-一种较慢的同步模式，旨在同步运行时间较长的动画状态。根据参数更改（每秒1到10次更新）根据需要每0.1到1秒更新一次，但您不应该依赖它来实现快速同步。
-**IK**-一种更快的同步模式，用于同步经常变化的值。每0.1秒连续更新一次（每秒10次更新），并在本地为远程用户插入“浮点数”值。根据参数，这也可能只是根据头像的本地渲染IK状态计算出来的。

当表达式参数在Puppet菜单中使用时，它会自动从Playable切换到IK同步，因此您可以获得持续的更新率和平滑的插值。当菜单关闭时，它会返回到Playable同步。

### 驱动表达式参数

此外，表达式参数可以通过状态行为“驱动”到一个值。它们可以在动画师的状态下使用“头像参数驱动程序”状态行为进行设置。

### AFK State

挂机状态触发：

-用户取下耳机和HMD接近传感器返回耳机未佩戴
-系统菜单打开。这取决于您使用的平台在系统菜单打开时如何传递数据——例如，Oculus Dash不注册为挂机，但SteamVR的菜单**注册为挂机。这是一种连锁反应，而不是设计好的行为。
-用户按下结束键，切换挂机状态。

### TrackingType参数

TrackingType表示一些信息。

如果值为3、4或6，而“VRMode”为1，则该值指示化身佩戴者已启用和当前跟踪的跟踪点数量。**此值可以更改！**如果用户在6点跟踪中删除了他们额外的3点跟踪，他们将从值6变为值3。在设计动画师时考虑到这一点。

如果值为0、1或2，而“VRMode”为1，则该值表示头像仍在初始化。您不应该将动画师设计为基于此值组合的分支，而是应该等待3、4或6的“有效”值。

：：：注意更改帐户

在头像初始化期间，此值可能会更改！确保您的动画师考虑到可能的更改，并且它不会“死胡同”到任何分支。

:::

|参数|描述|
| --- | :-- |
|0|未初始化。通常仅在用户切换头像并且他们的IK尚未发送时发生。|
|1|通用装备。用户可能有任何类型的跟踪，但头像被操纵为通用，因此跟踪被忽略。如果“VRMode”为0，_Might_是桌面用户。|
|2|AV2会出现_Only，因此对于头像上的AV3控制器，您不应该期待很长时间处于这种状态。SDK3站仍可能出现这种情况。_<br/>不用手指进行手动跟踪。这只会发生在过渡状态中——例如，您应该期望“TrackingType”再次更改，头像不应该保持这种状态。|
|3|头部和手部跟踪。如果“VRMode”是“1”，则此用户处于3点VR中。如果“VRMode”是“0”，则这是人形头像中的桌面用户。|
|4|4点VR用户。头、手和臀部。|
|5|5点VR用户。跟踪头、手和脚。基本上是完整的身体跟踪，但没有臀部。|
|6|全身跟踪VR用户。跟踪头、手、臀部和脚。|


### 表达式参数混叠

您**必须**为表达式参数创建名称（或“别名”）。**您不能（也不应该！）为参数使用默认表达式名称。**

一旦你为任何你想要使用的表达式参数创建了名称，你就可以直接在你的控制器中使用该名称。这意味着可以为你的参数想出你自己的标准命名。这_also_意味着菜单定义和控制器可以混合和匹配，只要它们使用相同的名称。你可以从别人那里得到预制控制器，并根据你的偏好创建自己的菜单样式，而不用担心表达式参数冲突。

在命名自己的参数时，使用正斜杠 (`/`) 将导致参数在各种选择下拉列表中自动组织。例如，将参数命名为“切换/帽子”将使菜单选择在为动画转换和表达式菜单等选择参数时显示为切换->帽子，同时保持底层参数的名称相同。这不会改变参数的行为方式，只是更容易处理大型参数列表。

### 默认AV3混叠

如果您不想构建自己的控制器，模板AV3 VRChat控制器可以使用一些“默认值”。由于混淆现象，这些不会与您自己的使用发生冲突（只要您不将它们命名为相同的东西）。

特别是，默认操作和FX层使用混淆现象。您不需要担心使用这些层中的表达式。

操作使用名为“VRCEmote”的别名参数，它是范围为1到16的Int。

如果您想尝试自己的菜单来使用它们，FX使用名为“VRCFaceBlendH”（-1,1）和“VRCFaceBlendV”（-1,1）的别名浮点参数。默认的FX层要求您有一个名为“身体”的蒙皮网格，带有“mood_happy”、“mood_sad”、“mood_surprised”和“mood_angry”混合形状。

重申一下，如果你有一个头像作为Avatar3头像上传，没有任何自定义的可播放图层，只要你有上面命名的混合形状，你就可以使用一些内置的表情符号。

如果你也有一个“eyes_closed”混合形状，它会在你使用默认的死亡表情或挂机时关闭它们。

### 跨平台参数同步

使用同时上传了Quest和PC版本的头像时，参数按其在参数列表中的位置及其参数类型同步，**而不是**按参数名称同步。对于要在PC和Quest之间同步的给定参数，它必须在参数列表中的相同位置，并且具有相同的参数类型。

有鉴于此，为化身的PC和Quest版本使用相同的表达式参数资产可能是一个好主意，即使一个版本没有使用所有参数。

### 不匹配的参数类型转换

当您在[参数类型](/avatars/animator-parameters/#parameter-types)中选择[动画师](https://docs.unity3d.com/Manual/AnimationParameters.html)时，最好选择与您尝试使用的[内置参数](/avatars/animator-parameters/#parameters)或[自定义参数](/avatars/expression-menu-and-controls/#creating-an-expression-menu)相同的类型。例如：如果您在动画师中使用VRChat的内置'挂机'参数，您应该选择类型'bool'。

但是，您*可以*为您的参数选择不匹配的类型。VRChat将尝试将参数的值转换为动画师使用的类型。例如，如果您为挂机参数选择类型“浮点数”，VRChat将自动将“挂机”设置为“1.0”或“0.0”，而不是“真”或“假”。这也允许您在动画师的[混合树](https://docs.unity3d.com/Manual/class-BlendTree.html)中使用“挂机”参数。

下表显示了转换不匹配的参数如何改变它。

|源类型|动画类型|转换行为|示例|
|:-----------:|:-------------:|:-------------------------------------------------------------------------------------------------------------：|---------------------------------------|
|'int'|'浮点数'|直接转换为'浮点数'。|'1'→'1.0'|
|'int'|'bool'|'0'是'false'，其他都是'true'|'1'→'true'|
|'float'|'int'|舍入到最接近的'int'（与___LINK相同___) | `0.5'→'0'，'0.6'→'1'，'1.5'→'2'|
|'float'|'bool'|'0.0'是'false'，其他都是'true'|'0.5'→'true'|
|'bool'|'int'|'true'是'1'，'false'是'0'|'true'→'1'|
|'bool'|'float'|'true'是'1.0'，'false'是'0.0'|'true'→'1.0'|
